================================================================================
                    HÆ¯á»šNG DáºªN CHI TIáº¾T JEST MOCK TESTING
================================================================================

ğŸ“‹ Má»¤C Lá»¤C:
1. Jest.mock() lÃ  gÃ¬?
2. Mock Data & Mock Functions
3. CÃ¡c HÃ m Mock ChÃ­nh
4. Helper Functions
5. TÃ¬m Kiáº¿m Elements (screen)
6. TÆ°Æ¡ng TÃ¡c NgÆ°á»i DÃ¹ng (userEvent)
7. Kiá»ƒm Tra Káº¿t Quáº£ (Assertions)
8. Luá»“ng Test HoÃ n Chá»‰nh
9. VÃ­ Dá»¥ Thá»±c Táº¿

================================================================================
1. JEST.MOCK() LÃ€ GÃŒ?
================================================================================

Äá»‹nh nghÄ©a:
  jest.mock('../services/productService');
  
  â†’ Giáº£ láº­p (mock) module productService
  â†’ KhÃ´ng gá»i API tháº­t, dÃ¹ng API giáº£

Táº¡i sao cáº§n?
  âŒ KhÃ´ng dÃ¹ng mock:
     - Pháº£i cháº¡y backend server
     - Gá»i API tháº­t ráº¥t cháº­m
     - Test cÃ³ thá»ƒ tháº¥t báº¡i náº¿u server down
     - KhÃ³ kiá»ƒm soÃ¡t káº¿t quáº£

  âœ… DÃ¹ng mock:
     - KhÃ´ng cáº§n backend, chá»‰ frontend
     - Test cháº¡y nhanh (< 1s)
     - Káº¿t quáº£ Ä‘Ã¡ng tin cáº­y
     - Dá»… test cÃ¡c trÆ°á»ng há»£p lá»—i

Lá»£i Ã­ch:
  â€¢ Unit Test Ä‘á»™c láº­p - khÃ´ng phá»¥ thuá»™c vÃ o module khÃ¡c
  â€¢ Kiá»ƒm soÃ¡t output - chÃºng ta quyáº¿t Ä‘á»‹nh hÃ m tráº£ vá» gÃ¬
  â€¢ Test cÃ¡c trÆ°á»ng há»£p hiáº¿m gáº·p (lá»—i server, timeout, v.v.)
  â€¢ Cháº¡y test nhanh hÆ¡n 10x so vá»›i gá»i API tháº­t

================================================================================
2. MOCK DATA & MOCK FUNCTIONS
================================================================================

A) MOCK DATA - Dá»¯ Liá»‡u Giáº£
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const mockProductList = [
  {
    id: 1,
    name: 'Laptop Dell',
    productName: 'Laptop Dell',
    price: 15000000,
    quantity: 10,
    category: 'Electronics',
    description: 'MÃ´ táº£ sáº£n pháº©m máº«u'
  }
];

Ã nghÄ©a:
  â€¢ Giáº£ láº­p dá»¯ liá»‡u mÃ  API tráº£ vá»
  â€¢ DÃ¹ng trong mockResolvedValue()
  â€¢ CÃ³ thá»ƒ táº¡o nhiá»u mock data cho cÃ¡c scenario khÃ¡c nhau

B) MOCK FUNCTIONS - HÃ m Giáº£
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
jest.mock('../services/productService');
â†“
productService.getAllProducts       â† HÃ m giáº£
productService.createProduct        â† HÃ m giáº£
productService.updateProduct        â† HÃ m giáº£
productService.deleteProduct        â† HÃ m giáº£

Sau khi mock:
  â€¢ Táº¥t cáº£ hÃ m trong productService trá»Ÿ thÃ nh "spy"
  â€¢ CÃ³ thá»ƒ:
    - Kiá»ƒm soÃ¡t return value (mockResolvedValue)
    - Kiá»ƒm soÃ¡t error (mockRejectedValue)
    - Kiá»ƒm tra cÃ³ Ä‘Æ°á»£c gá»i khÃ´ng (toHaveBeenCalled)
    - Kiá»ƒm tra gá»i vá»›i tham sá»‘ nÃ o (toHaveBeenCalledWith)
    - Kiá»ƒm tra gá»i bao nhiÃªu láº§n (toHaveBeenCalledTimes)

================================================================================
3. CÃC HÃ€M MOCK CHÃNH
================================================================================

A) beforeEach() - Chuáº©n Bá»‹ TrÆ°á»›c Má»—i Test
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
beforeEach(() => {
  jest.clearAllMocks();
  productService.getAllProducts.mockResolvedValue(mockProductList);
});

Cháº¡y trÆ°á»›c má»—i test() Ä‘á»ƒ:
  âœ“ jest.clearAllMocks()
    â†’ XÃ³a lá»‹ch sá»­ gá»i hÃ m tá»« test trÆ°á»›c
    â†’ LÃ m sáº¡ch mock states
    
  âœ“ mockResolvedValue()
    â†’ Thiáº¿t láº­p láº¡i giÃ¡ trá»‹ tráº£ vá»
    â†’ Chuáº©n bá»‹ dá»¯ liá»‡u cho test má»›i

Táº¡i sao cáº§n?
  Test 1: getAllProducts() Ä‘Æ°á»£c gá»i 1 láº§n
  Test 2: getAllProducts() Ä‘Æ°á»£c gá»i láº¡i
    â†’ Náº¿u khÃ´ng clearAllMocks(), sáº½ tháº¥y 2 láº§n gá»i (1 + 1)
    â†’ Káº¿t quáº£ sai! Pháº£i clear trÆ°á»›c

B) mockResolvedValue() - ThÃ nh CÃ´ng
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
productService.getAllProducts.mockResolvedValue(mockProductList);

Ã nghÄ©a:
  â€¢ Khi getAllProducts() Ä‘Æ°á»£c gá»i
  â€¢ NÃ³ tráº£ vá» Promise.resolve(mockProductList)
  â€¢ Giá»‘ng nhÆ° server tráº£ vá» dá»¯ liá»‡u thÃ nh cÃ´ng

VÃ­ dá»¥:
  const products = await productService.getAllProducts();
  // products = mockProductList
  // products = [{ id: 1, name: 'Laptop Dell', ... }]

C) mockRejectedValue() - Lá»—i
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
productService.createProduct.mockRejectedValue(
  new Error('Server Error')
);

Ã nghÄ©a:
  â€¢ Khi createProduct() Ä‘Æ°á»£c gá»i
  â€¢ NÃ³ tráº£ vá» Promise.reject(Error)
  â€¢ Giá»‘ng nhÆ° server lá»—i/khÃ´ng pháº£n há»“i

VÃ­ dá»¥:
  try {
    await productService.createProduct(data);
  } catch (error) {
    console.log(error.message); // 'Server Error'
  }

================================================================================
4. HELPER FUNCTIONS - HÃ€M Há»– TRá»¢
================================================================================

const fillAndSubmitForm = async (user) => {
  // 1. Má»Ÿ Modal
  await user.click(screen.getByText(/ThÃªm Sáº£n Pháº©m/i));
  
  // 2. Äiá»n Form
  await user.type(screen.getByLabelText(/tÃªn sáº£n pháº©m/i), 'New Laptop');
  await user.type(screen.getByLabelText(/giÃ¡/i), '20000000');
  await user.type(screen.getByLabelText(/sá»‘ lÆ°á»£ng/i), '5');
  await user.selectOptions(screen.getByLabelText(/danh má»¥c/i), 'Electronics');
  await user.type(screen.getByLabelText(/mÃ´ táº£/i), 'MÃ´ táº£ test');
  
  // 3. Submit
  const submitBtns = screen.getAllByRole('button', { name: /LÆ°u|ThÃªm|Cáº­p Nháº­t/i });
  const submitBtn = submitBtns[submitBtns.length - 1];
  await user.click(submitBtn);
};

Lá»£i Ã­ch:
  â€¢ TÃ¡i sá»­ dá»¥ng code test
  â€¢ Giáº£m code láº·p láº¡i
  â€¢ Dá»… báº£o trÃ¬

CÃ¡ch sá»­ dá»¥ng:
  test('Create product thÃ nh cÃ´ng', async () => {
    const user = userEvent.setup();
    productService.createProduct.mockResolvedValue({ id: 2 });
    
    render(<ProductManagement />);
    await fillAndSubmitForm(user);  // â† Chá»‰ cáº§n 1 dÃ²ng!
    
    // Kiá»ƒm tra káº¿t quáº£...
  });

================================================================================
5. TÃŒM KIáº¾M ELEMENTS (screen)
================================================================================

A) screen.getByText() - TÃ¬m Theo Text
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
screen.getByText(/ThÃªm Sáº£n Pháº©m/i)

Ã nghÄ©a:
  â€¢ TÃ¬m element chá»©a text "ThÃªm Sáº£n Pháº©m"
  â€¢ /i = Case insensitive (khÃ´ng phÃ¢n biá»‡t hoa/thÆ°á»ng)

VÃ­ dá»¥:
  âœ“ screen.getByText(/ThÃªm Sáº£n Pháº©m/i)   â†’ TÃ¬m "ThÃªm Sáº£n Pháº©m"
  âœ“ screen.getByText('Laptop Dell')       â†’ TÃ¬m text chÃ­nh xÃ¡c
  âœ— screen.getByText('TÃ¬m kiáº¿m')          â†’ KhÃ´ng tÃ¬m tháº¥y (náº¿u khÃ´ng cÃ³)

B) screen.getByLabelText() - TÃ¬m Input Theo Label
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
screen.getByLabelText(/tÃªn sáº£n pháº©m/i)

Ã nghÄ©a:
  â€¢ TÃ¬m <input> cÃ³ <label> chá»©a text "tÃªn sáº£n pháº©m"
  
HTML:
  <label>TÃªn sáº£n pháº©m</label>
  <input type="text" />
  â†‘â†‘ getByLabelText sáº½ tÃ¬m cÃ¡i input nÃ y

C) screen.getAllByRole() - TÃ¬m Táº¥t Cáº£ Element Theo Role
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
screen.getAllByRole('button', { name: /LÆ°u|ThÃªm|Cáº­p Nháº­t/i })

Ã nghÄ©a:
  â€¢ TÃ¬m táº¥t cáº£ <button> cÃ³ text khá»›p vá»›i regex
  â€¢ /LÆ°u|ThÃªm|Cáº­p Nháº­t/ = TÃ¬m má»™t trong 3 text nÃ y

VÃ­ dá»¥ káº¿t quáº£:
  [
    <button>ThÃªm Sáº£n Pháº©m</button>,    // [0]
    <button>LÆ°u</button>               // [1] â† submitBtn
  ]
  
  const submitBtns = screen.getAllByRole('button', {...});
  const submitBtn = submitBtns[submitBtns.length - 1]; // Chá»n nÃºt cuá»‘i cÃ¹ng

D) screen.getAllByTitle() - TÃ¬m Theo Title Attribute
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
screen.getAllByTitle(/XÃ³a/i)

Ã nghÄ©a:
  â€¢ TÃ¬m táº¥t cáº£ element cÃ³ title="XÃ³a"

HTML:
  <button title="XÃ³a">ğŸ—‘ï¸</button>
  â†“
  screen.getAllByTitle(/XÃ³a/i) â†’ [<button>]

E) screen.getByRole() vs screen.getAllByRole()
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
getByRole()     â†’ TÃ¬m 1 element (lá»—i náº¿u cÃ³ nhiá»u hoáº·c khÃ´ng cÃ³)
getAllByRole()  â†’ TÃ¬m nhiá»u elements (tráº£ vá» array)

================================================================================
6. TÆ¯Æ NG TÃC NGÆ¯á»œI DÃ™NG (userEvent)
================================================================================

A) user.click() - Click
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
await user.click(screen.getByText(/ThÃªm Sáº£n Pháº©m/i));

Ã nghÄ©a:
  â€¢ Giáº£ láº­p user click vÃ o button
  â€¢ KÃ­ch hoáº¡t onClick event

B) user.type() - GÃµ Text
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
await user.type(screen.getByLabelText(/tÃªn sáº£n pháº©m/i), 'New Laptop');

Ã nghÄ©a:
  â€¢ Giáº£ láº­p user gÃµ chá»¯ vÃ o input
  â€¢ KÃ­ch hoáº¡t onChange event

C) user.clear() - XÃ³a Text
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
await user.clear(screen.getByLabelText(/giÃ¡/i));

Ã nghÄ©a:
  â€¢ XÃ³a táº¥t cáº£ text trong input
  â€¢ ThÆ°á»ng dÃ¹ng trÆ°á»›c khi type text má»›i

D) user.selectOptions() - Chá»n Dropdown
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
await user.selectOptions(
  screen.getByLabelText(/danh má»¥c/i),
  'Electronics'
);

Ã nghÄ©a:
  â€¢ Chá»n option 'Electronics' tá»« <select>

HTML:
  <select>
    <option value="">Chá»n danh má»¥c</option>
    <option value="Electronics">Electronics</option>
    <option value="Books">Books</option>
  </select>

E) Táº¡i sao dÃ¹ng userEvent?
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
userEvent láº­p mÃ´ phá»ng hÃ nh Ä‘á»™ng thá»±c táº¿ cá»§a ngÆ°á»i dÃ¹ng
  â€¢ PhÃ­m táº¯t
  â€¢ TÆ°Æ¡ng tÃ¡c cháº­m (typing tá»«ng chá»¯ cÃ¡i)
  â€¢ CÃ¡c sá»± kiá»‡n phá»©c táº¡p

Tá»‘t hÆ¡n fireEvent (cÃ¡ch cÅ©):
  fireEvent chá»‰ kÃ­ch hoáº¡t event, khÃ´ng giáº£ láº­p ngÆ°á»i dÃ¹ng

================================================================================
7. KIá»‚M TRA Káº¾T QUáº¢ (ASSERTIONS)
================================================================================

A) toHaveBeenCalledTimes() - Kiá»ƒm Tra Sá»‘ Láº§n Gá»i
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
expect(productService.getAllProducts).toHaveBeenCalledTimes(1);

Ã nghÄ©a:
  â€¢ Kiá»ƒm tra getAllProducts() Ä‘Æ°á»£c gá»i Ä‘Ãºng 1 láº§n
  â€¢ Náº¿u gá»i 2 láº§n â†’ test fail

VÃ­ dá»¥:
  test('getAllProducts Ä‘Æ°á»£c gá»i 1 láº§n', () => {
    render(<ProductManagement />);
    expect(productService.getAllProducts).toHaveBeenCalledTimes(1);
  });

B) toHaveBeenCalledWith() - Kiá»ƒm Tra Tham Sá»‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
expect(productService.createProduct).toHaveBeenCalledWith(
  expect.objectContaining({
    productName: 'New Laptop',
    price: '20000000'
  })
);

Ã nghÄ©a:
  â€¢ Kiá»ƒm tra createProduct() Ä‘Æ°á»£c gá»i vá»›i tham sá»‘ cá»¥ thá»ƒ
  â€¢ expect.objectContaining() â†’ Chá»‰ kiá»ƒm tra nhá»¯ng field nÃ o mÃ¬nh muá»‘n
  
VÃ­ dá»¥:
  // Kiá»ƒm tra tÃªn vÃ  giÃ¡
  expect(createProduct).toHaveBeenCalledWith(
    expect.objectContaining({
      productName: 'New Laptop',  // âœ“ Pháº£i chÃ­nh xÃ¡c
      price: '20000000'            // âœ“ Pháº£i chÃ­nh xÃ¡c
      // KhÃ´ng kiá»ƒm tra category, description v.v.
    })
  );

C) toBeInTheDocument() - Element CÃ³ Trong DOM
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
expect(screen.getByText('Laptop Dell')).toBeInTheDocument();

Ã nghÄ©a:
  â€¢ Element cÃ³ trong DOM hay khÃ´ng
  â€¢ DÃ¹ng Ä‘á»ƒ kiá»ƒm tra UI sau khi action

D) toHaveBeenCalled() - Kiá»ƒm Tra CÃ³ ÄÆ°á»£c Gá»i
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
expect(productService.deleteProduct).toHaveBeenCalled();

Ã nghÄ©a:
  â€¢ Kiá»ƒm tra hÃ m Ä‘Æ°á»£c gá»i Ã­t nháº¥t 1 láº§n
  â€¢ KhÃ´ng kiá»ƒm tra sá»‘ láº§n cá»¥ thá»ƒ

================================================================================
8. LUá»’NG TEST HOÃ€N CHá»ˆNH
================================================================================

BÆ¯á»šC 1: SETUP (beforeEach)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
beforeEach(() => {
  jest.clearAllMocks();  // â† XÃ³a lá»‹ch sá»­ cÅ©
  productService.getAllProducts.mockResolvedValue(mockProductList);
});
|
â”œâ”€ XÃ³a táº¥t cáº£ lá»‹ch sá»­ gá»i hÃ m tá»« test trÆ°á»›c
â””â”€ Thiáº¿t láº­p mock data má»›i

BÆ¯á»šC 2: RENDER COMPONENT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
render(<ProductManagement />);
|
â”œâ”€ Component render
â””â”€ Gá»i getAllProducts() â†’ Tráº£ vá» mockProductList (mock)

BÆ¯á»šC 3: USER INTERACTION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const user = userEvent.setup();
await user.click(screen.getByText(/ThÃªm Sáº£n Pháº©m/i));
await user.type(screen.getByLabelText(/tÃªn sáº£n pháº©m/i), 'New Laptop');
|
â”œâ”€ User click button
â”œâ”€ Modal má»Ÿ
â””â”€ Form Ä‘iá»n dá»¯ liá»‡u

BÆ¯á»šC 4: SUBMIT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
await user.click(submitBtn);
|
â””â”€ Gá»i createProduct() â†’ Tráº£ vá» response giáº£ (mock)

BÆ¯á»šC 5: WAIT FOR RESULT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
await waitFor(() => {
  expect(screen.getByText(/thÃ nh cÃ´ng/i)).toBeInTheDocument();
});
|
â”œâ”€ Chá» component update state
â””â”€ Chá» success message xuáº¥t hiá»‡n

BÆ¯á»šC 6: ASSERTIONS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
expect(productService.createProduct).toHaveBeenCalledWith({...});
expect(productService.createProduct).toHaveBeenCalledTimes(1);
|
â”œâ”€ Kiá»ƒm tra tham sá»‘ Ä‘Æ°á»£c truyá»n
â””â”€ Kiá»ƒm tra sá»‘ láº§n gá»i

================================================================================
9. VÃ Dá»¤ THá»°C Táº¾
================================================================================

A) TEST Táº OW Sáº¢N PHáº¨M THÃ€NH CÃ”NG
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

test('Mock: Create product thÃ nh cong', async () => {
  // Setup
  const user = userEvent.setup();
  const newProductResponse = { id: 2, name: 'New Laptop', price: 20000000 };
  productService.createProduct.mockResolvedValue(newProductResponse);
  
  // Render
  render(<ProductManagement />);
  
  // Action
  await fillAndSubmitForm(user);
  
  // Assert
  await waitFor(() => {
    // Kiá»ƒm tra hÃ m Ä‘Æ°á»£c gá»i vá»›i tham sá»‘ Ä‘Ãºng
    expect(productService.createProduct).toHaveBeenCalledWith(
      expect.objectContaining({
        productName: 'New Laptop',
        price: '20000000'
      })
    );
    
    // Kiá»ƒm tra success message xuáº¥t hiá»‡n
    expect(screen.getByText(/thÃ nh cÃ´ng/i)).toBeInTheDocument();
  });
});

Giáº£i thÃ­ch:
  1. Setup: Táº¡o user object, mock API tráº£ vá» response
  2. Render: Hiá»ƒn thá»‹ component
  3. Action: User click button, Ä‘iá»n form, submit
  4. Assert: Kiá»ƒm tra API Ä‘Æ°á»£c gá»i Ä‘Ãºng, message xuáº¥t hiá»‡n

B) TEST Táº O Sáº¢N PHáº¨M THáº¤T Báº I
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

test('Mock: Create product that bai (Failure Scenario)', async () => {
  // Setup
  const user = userEvent.setup();
  productService.createProduct.mockRejectedValue(
    new Error('Server Error')
  );
  
  // Render
  render(<ProductManagement />);
  
  // Action
  await fillAndSubmitForm(user);
  
  // Assert
  await waitFor(() => {
    // Kiá»ƒm tra API Ä‘Æ°á»£c gá»i
    expect(productService.createProduct).toHaveBeenCalledTimes(1);
    
    // Kiá»ƒm tra error message xuáº¥t hiá»‡n
    expect(screen.getByText(/Server Error/i)).toBeInTheDocument();
  });
});

Giáº£i thÃ­ch:
  â€¢ mockRejectedValue() â†’ API tráº£ vá» lá»—i
  â€¢ Test kiá»ƒm tra component xá»­ lÃ½ lá»—i Ä‘Ãºng

C) TEST Cáº¬P NHáº¬T Sáº¢N PHáº¨M
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

test('Mock: Update product', async () => {
  // Setup
  const user = userEvent.setup();
  productService.updateProduct.mockResolvedValue({ success: true });
  
  // Render
  render(<ProductManagement />);
  await waitFor(() => screen.getByText('Laptop Dell'));
  
  // Action: Click nÃºt chá»‰nh sá»­a
  const editBtns = screen.getAllByTitle(/Chá»‰nh sá»­a/i);
  await user.click(editBtns[0]);
  
  // Sá»­a giÃ¡
  const priceInput = screen.getByLabelText(/giÃ¡/i);
  await user.clear(priceInput);
  await user.type(priceInput, '18000000');
  
  // Submit
  const submitBtns = screen.getAllByRole('button', { name: /LÆ°u|Cáº­p nháº­t/i });
  await user.click(submitBtns[submitBtns.length - 1]);
  
  // Assert
  await waitFor(() => {
    expect(productService.updateProduct).toHaveBeenCalledWith(
      1,  // Product ID
      expect.objectContaining({
        price: '18000000'
      })
    );
  });
});

================================================================================
10. CHEAT SHEET - TÃ“MI Táº®T
================================================================================

SETUP:
  jest.mock('../services/productService');
  beforeEach(() => {
    jest.clearAllMocks();
    productService.getAllProducts.mockResolvedValue(mockProductList);
  });

MOCK DATA:
  const mockData = { id: 1, name: 'Product' };

MOCK RESOLVE:
  productService.getProducts.mockResolvedValue(mockData);

MOCK REJECT:
  productService.getProducts.mockRejectedValue(new Error('Fail'));

RENDER:
  render(<ComponentName />);

USER ACTIONS:
  await user.click(element);
  await user.type(input, 'text');
  await user.clear(input);
  await user.selectOptions(select, 'value');

FIND ELEMENTS:
  screen.getByText(/text/i)
  screen.getByLabelText(/label/i)
  screen.getAllByRole('button', { name: /text/i })
  screen.getAllByTitle(/title/i)

WAIT:
  await waitFor(() => { ... });

ASSERTIONS:
  expect(element).toBeInTheDocument();
  expect(fn).toHaveBeenCalledTimes(1);
  expect(fn).toHaveBeenCalledWith(args);
  expect(fn).toHaveBeenCalled();

================================================================================
                              Háº¾T
================================================================================
